<canvas id="canvas" height="1000" width="500"></canvas>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let last = performance.now();

    const stackBlock = {
        x: 0,
        y: canvas.height - 20,
        width: 200,
        height: 20,
        direction: 1,
        speed: 3
    }

    class placedBlock {
        constructor(x, y, width, height) {
            this.x = x;
            this.y = y;
            this.width = width;
            this.height = height;
        }
    }

    const placedBlocks = [];


    // listeners
    window.addEventListener("keydown", () => {
        if (window.event.code === 'Space') {
            const aplacedBlock = new placedBlock(stackBlock.x, stackBlock.y, stackBlock.width, stackBlock.height);
            placedBlocks.push(aplacedBlock)
            stackBlock.y -= stackBlock.height;
            stackBlock.speed += 0.5
        }
    }, true);

    requestAnimationFrame(draw);

    function draw(timestamp) {
        requestAnimationFrame(draw);

        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.beginPath();
        ctx.rect(stackBlock.x, stackBlock.y, stackBlock.width, stackBlock.height);
        ctx.fillStyle = "#ffffff";
        ctx.fill();

        for (let i = 0; i < placedBlocks.length; i++) {
            block = placedBlocks[i];
            ctx.beginPath();
            ctx.rect(block.x, block.y, block.width, block.height);
            ctx.fill()
        }

        stackBlock.x += (timestamp - last) / 10 * stackBlock.direction * stackBlock.speed;

        let hasHitLeftWall = stackBlock.x <= 0 && stackBlock.direction != 1;
        let hasHitRightWall = stackBlock.x >= canvas.width - stackBlock.width && stackBlock.direction == 1;

        if (hasHitLeftWall || hasHitRightWall) {
            stackBlock.direction *= -1;
        }

        last = timestamp;
    }


</script>

<style>
    #canvas {
        background-color: black;
    }
</style>
